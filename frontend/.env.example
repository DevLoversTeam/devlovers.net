# --- Core / Environment
APP_ENV=
APP_URL=
NEXT_PUBLIC_SITE_URL=

# --- Database
DATABASE_URL=

# --- Auth (app)
AUTH_SECRET=

# --- OAuth: Google
GOOGLE_CLIENT_ID_DEVELOP=
GOOGLE_CLIENT_ID_LOCAL=
GOOGLE_CLIENT_ID_PROD=
GOOGLE_CLIENT_REDIRECT_URI_DEVELOP=
GOOGLE_CLIENT_REDIRECT_URI_LOCAL=
GOOGLE_CLIENT_REDIRECT_URI_PROD=
GOOGLE_CLIENT_SECRET_DEVELOP=
GOOGLE_CLIENT_SECRET_LOCAL=
GOOGLE_CLIENT_SECRET_PROD=

# --- OAuth: GitHub
GITHUB_CLIENT_ID_DEVELOP=
GITHUB_CLIENT_ID_LOCAL=
GITHUB_CLIENT_ID_PROD=
GITHUB_CLIENT_REDIRECT_URI_DEVELOP=
GITHUB_CLIENT_REDIRECT_URI_LOCAL=
GITHUB_CLIENT_REDIRECT_URI_PROD=
GITHUB_CLIENT_SECRET_DEVELOP=
GITHUB_CLIENT_SECRET_LOCAL=
GITHUB_CLIENT_SECRET_PROD=

# --- Cloudinary
CLOUDINARY_API_KEY=
CLOUDINARY_API_SECRET=
CLOUDINARY_CLOUD_NAME=
CLOUDINARY_UPLOAD_FOLDER=
CLOUDINARY_URL=

# --- Payments (Stripe)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=
PAYMENTS_ENABLED=
# Options: test, live (defaults to test in development, live in production)
STRIPE_MODE=
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=

# --- Admin / Internal ops
ENABLE_ADMIN_API=
INTERNAL_JANITOR_MIN_INTERVAL_SECONDS=
INTERNAL_JANITOR_SECRET=
JANITOR_URL=

# --- Quiz
QUIZ_ENCRYPTION_KEY=

# --- Telegram
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# --- Email (Gmail SMTP)
EMAIL_FROM=
GMAIL_APP_PASSWORD=
GMAIL_USER=

# --- Security
CSRF_SECRET=

CHECKOUT_RATE_LIMIT_MAX=10
CHECKOUT_RATE_LIMIT_WINDOW_SECONDS=300

# Stripe webhook rate limit envs (applied per reason; reason-specific overrides generic).
# Missing signature has its own envs with fallback to generic, then legacy invalid_sig.
STRIPE_WEBHOOK_MISSING_SIG_RL_MAX=30
STRIPE_WEBHOOK_MISSING_SIG_RL_WINDOW_SECONDS=60

# Generic Stripe webhook rate limit fallback (applies to missing_sig and invalid_sig).
STRIPE_WEBHOOK_RL_MAX=30
STRIPE_WEBHOOK_RL_WINDOW_SECONDS=60

# Invalid signature envs (canonical for invalid_sig, legacy fallback for missing_sig).
STRIPE_WEBHOOK_INVALID_SIG_RL_MAX=30
STRIPE_WEBHOOK_INVALID_SIG_RL_WINDOW_SECONDS=60

# SECURITY: If true, trust x-real-ip / x-forwarded-for headers for rate limiting.
# Enable ONLY behind Cloudflare or a trusted reverse proxy that overwrites these headers.
# Default: false (empty/0/false).
TRUST_FORWARDED_HEADERS=0

# emergency switch
RATE_LIMIT_DISABLED=0
