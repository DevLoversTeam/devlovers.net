# --- Core / Environment
APP_ADDITIONAL_ORIGINS=https://admin.example.test
APP_ENV=
APP_ORIGIN=https://example.test
APP_URL=
NEXT_PUBLIC_SITE_URL=

# --- Database
DATABASE_URL=

# --- Upstash Redis (REST)
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# --- Auth (app)
AUTH_SECRET=

# --- OAuth: Google
GOOGLE_CLIENT_ID_DEVELOP=
GOOGLE_CLIENT_ID_LOCAL=
GOOGLE_CLIENT_ID_PROD=
GOOGLE_CLIENT_REDIRECT_URI_DEVELOP=
GOOGLE_CLIENT_REDIRECT_URI_LOCAL=
GOOGLE_CLIENT_REDIRECT_URI_PROD=
GOOGLE_CLIENT_SECRET_DEVELOP=
GOOGLE_CLIENT_SECRET_LOCAL=
GOOGLE_CLIENT_SECRET_PROD=

# --- OAuth: GitHub
GITHUB_CLIENT_ID_DEVELOP=
GITHUB_CLIENT_ID_LOCAL=
GITHUB_CLIENT_ID_PROD=
GITHUB_CLIENT_REDIRECT_URI_DEVELOP=
GITHUB_CLIENT_REDIRECT_URI_LOCAL=
GITHUB_CLIENT_REDIRECT_URI_PROD=
GITHUB_CLIENT_SECRET_DEVELOP=
GITHUB_CLIENT_SECRET_LOCAL=
GITHUB_CLIENT_SECRET_PROD=
GITHUB_SPONSORS_TOKEN=

# --- Cloudinary
CLOUDINARY_API_KEY=
CLOUDINARY_API_SECRET=
CLOUDINARY_CLOUD_NAME=
CLOUDINARY_UPLOAD_FOLDER=
CLOUDINARY_URL=

# --- Payments (Stripe)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=
PAYMENTS_ENABLED=
# Options: test, live (defaults to test in development, live in production)
STRIPE_MODE=
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PAYMENTS_ENABLED=
# --- Payments (Monobank acquiring)
# Monobank acquiring (server-only). Use canonical MONO_* names.
# Required for invoice creation; secret (prod-only for live tokens).
MONO_MERCHANT_TOKEN=
# Optional: Base64/PEM public key for webhook verification (recommended in PROD).
MONO_PUBLIC_KEY=
# Optional: API base override (default: https://api.monobank.ua).
MONO_API_BASE=
# Optional: invoice create timeout in ms (default: 8000 prod / 12000 non-prod).
MONO_INVOICE_TIMEOUT_MS=
# Feature flags (Monobank contour only)
# Webhook mode: apply | store | drop (default: apply).
MONO_WEBHOOK_MODE=
# Refunds enabled: true | false (default: false).
MONO_REFUND_ENABLED=
# Optional: invoice validity in seconds (default: 86400).
MONO_INVOICE_VALIDITY_SECONDS=
# Optional: webhook time skew tolerance in seconds (default: 300).
MONO_TIME_SKEW_TOLERANCE_SEC=

# --- Shop
# Optional canonical base URL override for shop links/webhooks.
# Used to build Monobank redirect/webhook URLs. Fallback: APP_ORIGIN, then NEXT_PUBLIC_SITE_URL.
# In production, must be https.
SHOP_BASE_URL=
# Secret used to sign/verify short-lived shop status tokens for
# GET /api/shop/orders/[id]/status (post-redirect UI status polling).
# Must be a strong random string (>= 32 bytes). Keep server-only; do not expose to client.
# Generate (PowerShell):
#   node -e "console.log(require('crypto').randomBytes(48).toString('base64url'))"
SHOP_STATUS_TOKEN_SECRET=

# --- Admin / Internal ops
ENABLE_ADMIN_API=
INTERNAL_JANITOR_MIN_INTERVAL_SECONDS=
INTERNAL_JANITOR_SECRET=
JANITOR_URL=

# --- Quiz
QUIZ_ENCRYPTION_KEY=

# --- Telegram
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# --- Email (Gmail SMTP)
EMAIL_FROM=
GMAIL_APP_PASSWORD=
GMAIL_USER=

# --- Security
CSRF_SECRET=

CHECKOUT_RATE_LIMIT_MAX=10
CHECKOUT_RATE_LIMIT_WINDOW_SECONDS=300

# Stripe webhook rate limit envs (applied per reason; reason-specific overrides generic).
# Missing signature has its own envs with fallback to generic, then legacy invalid_sig.
STRIPE_WEBHOOK_MISSING_SIG_RL_MAX=30
STRIPE_WEBHOOK_MISSING_SIG_RL_WINDOW_SECONDS=60

# Generic Stripe webhook rate limit fallback (applies to missing_sig and invalid_sig).
STRIPE_WEBHOOK_RL_MAX=30
STRIPE_WEBHOOK_RL_WINDOW_SECONDS=60

# Invalid signature envs (canonical for invalid_sig, legacy fallback for missing_sig).
STRIPE_WEBHOOK_INVALID_SIG_RL_MAX=30
STRIPE_WEBHOOK_INVALID_SIG_RL_WINDOW_SECONDS=60

# SECURITY: If true, trust Cloudflare's cf-connecting-ip header for rate limiting.
# Enable ONLY when traffic is fronted by Cloudflare (header is set by Cloudflare at the edge).
# Default: false (0). Keep 0 in untrusted environments to avoid IP spoofing.
TRUST_CF_CONNECTING_IP=0

# SECURITY: If true, trust x-real-ip / x-forwarded-for headers for rate limiting.
# Enable ONLY behind Cloudflare or a trusted reverse proxy that overwrites these headers.
# Default: false (empty/0/false).
TRUST_FORWARDED_HEADERS=0

# emergency switch
RATE_LIMIT_DISABLED=0

GROQ_API_KEY=
